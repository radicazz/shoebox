---
interface ContactData {
  phone?: string;
  email?: string;
  github?: string;
  linkedin?: string;
}

export interface Props {
  contact: ContactData;
}

const { contact } = Astro.props as Props;

const normalizePhoneHref = (value?: string) => {
  if (!value) return undefined;
  const normalized = value.replace(/[^+\d]/g, '');
  return normalized ? `tel:${normalized}` : undefined;
};

const entries = [
  contact.phone
    ? {
        label: 'Phone',
        value: contact.phone,
        href: normalizePhoneHref(contact.phone),
      }
    : null,
  contact.email
    ? {
        label: 'Email',
        value: contact.email,
        href: `mailto:${contact.email}`,
      }
    : null,
  contact.github
    ? {
        label: 'GitHub',
        value: contact.github,
        href: contact.github,
      }
    : null,
  contact.linkedin
    ? {
        label: 'LinkedIn',
        value: contact.linkedin,
        href: contact.linkedin,
      }
    : null,
].filter((entry): entry is { label: string; value: string; href?: string } => Boolean(entry && entry.value));
---
{entries.length > 0 && (
  <div class="flex h-full flex-col rounded-2xl border border-gray-200/70 bg-white/80 p-6 text-left shadow-sm backdrop-blur dark:border-gray-700/60 dark:bg-gray-900/60">
    <p class="text-sm font-semibold uppercase tracking-wide text-gray-500 dark:text-gray-400">Contact</p>
    <dl class="mt-4 space-y-3 text-base text-gray-800 dark:text-gray-100">
      {entries.map((entry) => (
        <div>
          <dt class="text-xs font-semibold uppercase tracking-wide text-gray-500 dark:text-gray-400">{entry.label}</dt>
          {entry.href ? (
            <dd>
              <a
                href={entry.href}
                target={entry.href.startsWith('http') ? '_blank' : undefined}
                rel={entry.href.startsWith('http') ? 'noopener noreferrer' : undefined}
                class="text-base font-medium text-blue-600 transition hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300"
              >
                {entry.value}
              </a>
            </dd>
          ) : (
            <dd class="text-base font-medium">{entry.value}</dd>
          )}
        </div>
      ))}
    </dl>
  </div>
)}
